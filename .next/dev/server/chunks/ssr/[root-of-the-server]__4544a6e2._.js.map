{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 10, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/src/app/actions.ts"],"sourcesContent":["'use server';\n\nimport { GoogleGenerativeAI } from '@google/generative-ai';\nimport { PDFParse } from 'pdf-parse';\n\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY || '');\n\nexport async function generateManagementPlan(formData: FormData) {\n  const file = formData.get('file') as File;\n  if (!file) {\n    throw new Error('ファイルがアップロードされていません。');\n  }\n\n  const bytes = await file.arrayBuffer();\n  const buffer = Buffer.from(bytes);\n\n  // PDFからテキストを抽出\n  let extractedText = '';\n  try {\n    const parser = new PDFParse({ data: buffer });\n    const result = await parser.getText();\n    extractedText = result.pages.map((p: any) => p.text).join('\\n');\n  } catch (error) {\n    console.error('PDF parsing error:', error);\n    throw new Error('PDFの読み取りに失敗しました。');\n  }\n\n  if (!extractedText.trim()) {\n    throw new Error('PDFからテキストを抽出できませんでした。');\n  }\n\n  const model = genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });\n\n  const prompt = `\nあなたはプロの経営コンサルタント兼マーケッター兼編集者です。 私は社員20名以下の小規模企業の経営者です。これから『経営計画書』を作りたいので、以下の条件を満たす計画書を作成してください。\n【極めて重要な依頼：省略の禁止】 今回は**「第1章から第8章まで」**を作成してください。 AIによる情報の要約や抜粋は一切求めていません。全章において省略や抜粋をせず、第8章の施策50項目についても、すべて具体的な文章で書き出してください。 ボリューム不足や項目の欠落はエラーとみなします。出力がどれだけ長くなっても構いませんので、一文字も妥協せず完遂してください。\n🔗 参考情報の扱い方 【参考URL】\nURL1：\nURL2：\nURL3：\nURL4：\n【入力方法】 アップロードされた「ヒアリングシート（PDF）」の情報を骨格とし、URLやPDFがある場合はその内容を分析や行動例に必ず反映してください。無い場合は、業界知識をもとに補完してください。\n\n--- ヒアリングシートの内容 ---\n${extractedText}\n---------------------------\n\n🏗️ 経営計画書の構成（全8章）\n1. 会社概要\n2. これから目指す姿（将来構想）\n3. 今の状況を知る（SWOT分析）： 強み・弱み・機会・脅威を各3項目以上、Markdown表で提示。\n4. 分析を活かす作戦（クロスSWOT）： SO・WO・ST・WTを各3項目以上、Markdown表で提示。\n5. 私たちの立ち位置（戦略の優先順位）： 下記の定義に基づき、3つのレベルに必ず振り分ける。\n6. 中期目標： 5年後までの年度別目標を具体的に提示。\n7. 商圏・市場戦略： 地域密着か広域か、具体的なターゲットを含めて提示。\n8. 戦略と施策（★省略禁止★）： 5区分すべてを10項目ずつ（計50項目）、具体的な行動リストとして出力。\n\n📋 「私たちの立ち位置」戦略の定義\nアクセス： 物理的な利便性（立地、反応の速さ）に加え、**知的・機能的利便性（専門的な情報、高度なスキル、解決策への接触可能性）**も含む。\n商品： 提供する物品、または提供する役務（サービスそのもの）の品質、機能、正確さ、ブランドとしての信頼性。\nサービス： 契約や購入の前後に付随する対人対応の質。マナー、アフターフォロー、気配りの徹底。\n価格： 市場相場との整合性と「納得感」のある値付け。\n経験価値： **顧客が抱く精神的な満足感や安心感。**自社はそれが生まれる「舞台」を徹底的に設計する。\n\n📋 戦略と施策の5区分（各10項目・計50項目すべて出力）\n1. 商品・サービスをどうするか\n2. お客様にどう伝えるか（営業・販促）\n3. 仕事の進め方と品質\n4. 働く仲間とチームづくり\n5. ムダをなくすデジタル活用\n\n🗣️ 出力トーンと形式\nトーン： 正式文書トーン（外部提出可）。難しい言葉を避け、自然体で読みやすく。\n形式： Googleドキュメントに貼り付け可能なMarkdown形式。各章冒頭に「方向性・想い」を一文添える。\n\n【出力後の案内】 出力完了後、次のように尋ねてください。 「この経営計画書は、Googleドキュメントに貼り付けてお使いいただける形式で作成しました。このままテキスト全体をコピー＆ペーストして保存されることをおすすめします。Wordで出力したい場合は、一旦Googleドキュメントに貼り付け、その後『ファイル』＞『ダウンロード』＞『Microsoft Word（.docx）』を選択すると、きれいに保存できます。スライドにしたい場合は、ご自身で作成されるか、この計画書を原稿として専門業者に依頼されてみてください。\nなお、本内容はAIが業界知識やヒアリングシートに基づき作成した『参考情報』です。経営実態との相違がないか必ずご自身で内容を確認・修正し、正確性を高めた上でご活用ください。本資料の利用に関する最終的な判断と責任は、利用者様に帰属いたします。\n`;\n\n  try {\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    return response.text();\n  } catch (error) {\n    console.error('Gemini API error:', error);\n    throw new Error('AIによる生成中にエラーが発生しました。');\n  }\n}\n"],"names":[],"mappings":";;;;;;;MAOsB,wBAAA,WAAA,GAAA,IAAA,+OAAA,EAAA,8CAAA,oOAAA,EAAA,KAAA,GAAA,0OAAA,EAAA,0DAAA"}},
    {"offset": {"line": 87, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useState } from 'react';\nimport { generateManagementPlan } from './actions';\nimport ReactMarkdown from 'react-markdown';\nimport { Upload, FileText, Loader2, Copy, Check } from 'lucide-react';\nimport { clsx, type ClassValue } from 'clsx';\nimport { twMerge } from 'tailwind-merge';\n\nfunction cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs));\n}\n\nexport default function Home() {\n  const [file, setFile] = useState<File | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [result, setResult] = useState<string | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [copied, setCopied] = useState(false);\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      setFile(e.target.files[0]);\n      setError(null);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!file) {\n      setError('ファイルを選択してください。');\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n    setResult(null);\n\n    try {\n      const formData = new FormData();\n      formData.append('file', file);\n      const plan = await generateManagementPlan(formData);\n      setResult(plan);\n    } catch (err: any) {\n      setError(err.message || 'エラーが発生しました。');\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const copyToClipboard = () => {\n    if (result) {\n      navigator.clipboard.writeText(result);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 py-12 px-4 sm:px-6 lg:px-8\">\n      <div className=\"max-w-4xl mx-auto\">\n        <div className=\"text-center mb-12\">\n          <h1 className=\"text-4xl font-bold text-gray-900 mb-4\">\n            経営計画書作成 AI\n          </h1>\n          <p className=\"text-lg text-gray-600\">\n            インタビューシート（PDF）をアップロードして、AIが経営計画書を自動生成します。\n          </p>\n        </div>\n\n        <div className=\"bg-white shadow-xl rounded-2xl p-8 mb-8\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div className=\"flex items-center justify-center w-full\">\n              <label\n                htmlFor=\"dropzone-file\"\n                className={cn(\n                  \"flex flex-col items-center justify-center w-full h-64 border-2 border-dashed rounded-xl cursor-pointer transition-colors\",\n                  file ? \"border-blue-400 bg-blue-50\" : \"border-gray-300 bg-gray-50 hover:bg-gray-100\"\n                )}\n              >\n                <div className=\"flex flex-col items-center justify-center pt-5 pb-6\">\n                  {file ? (\n                    <>\n                      <FileText className=\"w-12 h-12 text-blue-500 mb-4\" />\n                      <p className=\"mb-2 text-sm text-blue-600 font-semibold\">\n                        {file.name}\n                      </p>\n                      <p className=\"text-xs text-blue-500\">\n                        {(file.size / 1024 / 1024).toFixed(2)} MB\n                      </p>\n                    </>\n                  ) : (\n                    <>\n                      <Upload className=\"w-12 h-12 text-gray-400 mb-4\" />\n                      <p className=\"mb-2 text-sm text-gray-500\">\n                        <span className=\"font-semibold\">クリックしてアップロード</span> またはドラッグ＆ドロップ\n                      </p>\n                      <p className=\"text-xs text-gray-400\">PDFファイルのみ対応</p>\n                    </>\n                  )}\n                </div>\n                <input\n                  id=\"dropzone-file\"\n                  type=\"file\"\n                  className=\"hidden\"\n                  accept=\".pdf\"\n                  onChange={handleFileChange}\n                />\n              </label>\n            </div>\n\n            {error && (\n              <div className=\"p-4 bg-red-50 border-l-4 border-red-400 text-red-700 text-sm\">\n                {error}\n              </div>\n            )}\n\n            <button\n              type=\"submit\"\n              disabled={!file || loading}\n              className={cn(\n                \"w-full flex items-center justify-center py-4 px-6 rounded-xl text-white font-bold text-lg transition-all\",\n                !file || loading\n                  ? \"bg-gray-400 cursor-not-allowed\"\n                  : \"bg-blue-600 hover:bg-blue-700 shadow-lg hover:shadow-xl active:scale-[0.98]\"\n              )}\n            >\n              {loading ? (\n                <>\n                  <Loader2 className=\"w-6 h-6 mr-3 animate-spin\" />\n                  作成中...\n                </>\n              ) : (\n                '経営計画書を作成する'\n              )}\n            </button>\n          </form>\n        </div>\n\n        {result && (\n          <div className=\"bg-white shadow-xl rounded-2xl overflow-hidden\">\n            <div className=\"flex items-center justify-between px-8 py-4 border-b border-gray-100 bg-gray-50\">\n              <h2 className=\"text-xl font-bold text-gray-800\">生成された経営計画書</h2>\n              <button\n                onClick={copyToClipboard}\n                className=\"flex items-center gap-2 px-4 py-2 text-sm font-medium text-blue-600 hover:bg-blue-50 rounded-lg transition-colors\"\n              >\n                {copied ? (\n                  <>\n                    <Check className=\"w-4 h-4\" />\n                    コピーしました\n                  </>\n                ) : (\n                  <>\n                    <Copy className=\"w-4 h-4\" />\n                    Markdownをコピー\n                  </>\n                )}\n              </button>\n            </div>\n            <div className=\"p-8 prose prose-blue max-w-none overflow-auto max-h-[800px]\">\n              <ReactMarkdown>{result}</ReactMarkdown>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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"}}]
}