{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/src/app/actions.ts"],"sourcesContent":["'use server';\n\nimport { GoogleGenerativeAI } from '@google/generative-ai';\nimport { PDFParse } from 'pdf-parse';\n\nconst genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY || '');\n\nexport async function generateManagementPlan(formData: FormData) {\n  const file = formData.get('file') as File;\n  if (!file) {\n    throw new Error('ファイルがアップロードされていません。');\n  }\n\n  const bytes = await file.arrayBuffer();\n  const buffer = Buffer.from(bytes);\n\n  // PDFからテキストを抽出\n  let extractedText = '';\n  try {\n    const parser = new PDFParse({ data: buffer });\n    const result = await parser.getText();\n    extractedText = result.pages.map((p: any) => p.text).join('\\n');\n  } catch (error) {\n    console.error('PDF parsing error:', error);\n    throw new Error('PDFの読み取りに失敗しました。');\n  }\n\n  if (!extractedText.trim()) {\n    throw new Error('PDFからテキストを抽出できませんでした。');\n  }\n\n  const model = genAI.getGenerativeModel({ model: 'gemini-1.5-flash' });\n\n  const prompt = `\nあなたはプロの経営コンサルタント兼マーケッター兼編集者です。 私は社員20名以下の小規模企業の経営者です。これから『経営計画書』を作りたいので、以下の条件を満たす計画書を作成してください。\n【極めて重要な依頼：省略の禁止】 今回は**「第1章から第8章まで」**を作成してください。 AIによる情報の要約や抜粋は一切求めていません。全章において省略や抜粋をせず、第8章の施策50項目についても、すべて具体的な文章で書き出してください。 ボリューム不足や項目の欠落はエラーとみなします。出力がどれだけ長くなっても構いませんので、一文字も妥協せず完遂してください。\n🔗 参考情報の扱い方 【参考URL】\nURL1：\nURL2：\nURL3：\nURL4：\n【入力方法】 アップロードされた「ヒアリングシート（PDF）」の情報を骨格とし、URLやPDFがある場合はその内容を分析や行動例に必ず反映してください。無い場合は、業界知識をもとに補完してください。\n\n--- ヒアリングシートの内容 ---\n${extractedText}\n---------------------------\n\n🏗️ 経営計画書の構成（全8章）\n1. 会社概要\n2. これから目指す姿（将来構想）\n3. 今の状況を知る（SWOT分析）： 強み・弱み・機会・脅威を各3項目以上、Markdown表で提示。\n4. 分析を活かす作戦（クロスSWOT）： SO・WO・ST・WTを各3項目以上、Markdown表で提示。\n5. 私たちの立ち位置（戦略の優先順位）： 下記の定義に基づき、3つのレベルに必ず振り分ける。\n6. 中期目標： 5年後までの年度別目標を具体的に提示。\n7. 商圏・市場戦略： 地域密着か広域か、具体的なターゲットを含めて提示。\n8. 戦略と施策（★省略禁止★）： 5区分すべてを10項目ずつ（計50項目）、具体的な行動リストとして出力。\n\n📋 「私たちの立ち位置」戦略の定義\nアクセス： 物理的な利便性（立地、反応の速さ）に加え、**知的・機能的利便性（専門的な情報、高度なスキル、解決策への接触可能性）**も含む。\n商品： 提供する物品、または提供する役務（サービスそのもの）の品質、機能、正確さ、ブランドとしての信頼性。\nサービス： 契約や購入の前後に付随する対人対応の質。マナー、アフターフォロー、気配りの徹底。\n価格： 市場相場との整合性と「納得感」のある値付け。\n経験価値： **顧客が抱く精神的な満足感や安心感。**自社はそれが生まれる「舞台」を徹底的に設計する。\n\n📋 戦略と施策の5区分（各10項目・計50項目すべて出力）\n1. 商品・サービスをどうするか\n2. お客様にどう伝えるか（営業・販促）\n3. 仕事の進め方と品質\n4. 働く仲間とチームづくり\n5. ムダをなくすデジタル活用\n\n🗣️ 出力トーンと形式\nトーン： 正式文書トーン（外部提出可）。難しい言葉を避け、自然体で読みやすく。\n形式： Googleドキュメントに貼り付け可能なMarkdown形式。各章冒頭に「方向性・想い」を一文添える。\n\n【出力後の案内】 出力完了後、次のように尋ねてください。 「この経営計画書は、Googleドキュメントに貼り付けてお使いいただける形式で作成しました。このままテキスト全体をコピー＆ペーストして保存されることをおすすめします。Wordで出力したい場合は、一旦Googleドキュメントに貼り付け、その後『ファイル』＞『ダウンロード』＞『Microsoft Word（.docx）』を選択すると、きれいに保存できます。スライドにしたい場合は、ご自身で作成されるか、この計画書を原稿として専門業者に依頼されてみてください。\nなお、本内容はAIが業界知識やヒアリングシートに基づき作成した『参考情報』です。経営実態との相違がないか必ずご自身で内容を確認・修正し、正確性を高めた上でご活用ください。本資料の利用に関する最終的な判断と責任は、利用者様に帰属いたします。\n`;\n\n  try {\n    const result = await model.generateContent(prompt);\n    const response = await result.response;\n    return response.text();\n  } catch (error) {\n    console.error('Gemini API error:', error);\n    throw new Error('AIによる生成中にエラーが発生しました。');\n  }\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;;;;;AAEA,MAAM,QAAQ,IAAI,oLAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc,IAAI;AAE5D,eAAe,uBAAuB,QAAkB;IAC7D,MAAM,OAAO,SAAS,GAAG,CAAC;IAC1B,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,MAAM,KAAK,WAAW;IACpC,MAAM,SAAS,OAAO,IAAI,CAAC;IAE3B,eAAe;IACf,IAAI,gBAAgB;IACpB,IAAI;QACF,MAAM,SAAS,IAAI,mLAAQ,CAAC;YAAE,MAAM;QAAO;QAC3C,MAAM,SAAS,MAAM,OAAO,OAAO;QACnC,gBAAgB,OAAO,KAAK,CAAC,GAAG,CAAC,CAAC,IAAW,EAAE,IAAI,EAAE,IAAI,CAAC;IAC5D,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,sBAAsB;QACpC,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,CAAC,cAAc,IAAI,IAAI;QACzB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,QAAQ,MAAM,kBAAkB,CAAC;QAAE,OAAO;IAAmB;IAEnE,MAAM,SAAS,CAAC;;;;;;;;;;;AAWlB,EAAE,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiChB,CAAC;IAEC,IAAI;QACF,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAC3C,MAAM,WAAW,MAAM,OAAO,QAAQ;QACtC,OAAO,SAAS,IAAI;IACtB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,MAAM,IAAI,MAAM;IAClB;AACF;;;IAhFsB;;AAAA,+OAAA"}},
    {"offset": {"line": 105, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {generateManagementPlan as '402de835c6f2b7e0fd639fbdf46f55bf2fe54478bf'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}