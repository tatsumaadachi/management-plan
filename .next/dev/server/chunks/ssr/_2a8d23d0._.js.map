{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/src/app/actions.ts"],"sourcesContent":["'use server';\n\nexport async function generateManagementPlan(formData: FormData) {\n  const apiKey = process.env.GEMINI_API_KEY;\n\n  if (!apiKey) {\n    throw new Error(\"APIキーが見つかりません。.env.localを確認してください。\");\n  }\n\n  // 入力項目の取得\n  const industry = formData.get('industry') as string || '（未入力：業界知識をもとに補完してください）';\n  const businessDetail = formData.get('businessDetail') as string || '（未入力：一般的な業務内容として補完してください）';\n  const hqLocation = formData.get('hqLocation') as string || '（未入力：一般的な地方都市として想定してください）';\n  const otherLocations = formData.get('otherLocations') as string || 'なし';\n  const businessArea = formData.get('businessArea') as string || '（未入力：一般的な商圏として補完してください）';\n  const employeeCount = formData.get('employeeCount') as string || '（未入力：小規模事業者として想定してください）';\n  const futureEmployeeCount = formData.get('futureEmployeeCount') as string || 'なし（現状維持）';\n  const strengths = formData.get('strengths') as string || '（未入力：この業種の一般的な強みを補完してください）';\n  const issues = formData.get('issues') as string || '（未入力：この業種の一般的な課題を補完してください）';\n  const newInitiatives = formData.get('newInitiatives') as string || '（未入力：特になし。架空の新規事業は提案せず、既存事業の強化・改善・品質向上を軸に計画してください）';\n  const targetCustomers = formData.get('targetCustomers') as string || '（未入力：一般的なターゲット層を想定してください）';\n  const acquisitionChannel = formData.get('acquisitionChannel') as string || '（未入力：一般的な集客経路を想定してください）';\n  const vision = formData.get('vision') as string || '（未入力：持続的な成長と地域貢献）';\n\n  // 指示文（プロンプト）\n  const prompt = `\nあなたは**世界最高の**経営コンサルタント兼マーケッター兼編集者です。 私は社員20名以下の小規模企業の経営者です。これから『経営計画書』を作りたいので、以下の条件を満たす計画書を作成してください。\n\n【極めて重要な依頼：省略の禁止】\n今回は**「第1章から第8章まで」**を作成してください。 AIによる情報の要約や抜粋は一切求めていません。全章において省略や抜粋をせず、第8章の施策50項目についても、すべて具体的な文章で書き出してください。 ボリューム不足や項目の欠落はエラーとみなします。出力がどれだけ長くなっても構いませんので、一文字も妥協せず完遂してください。\n\n【入力方法】\n以下の「ヒアリングシート（入力フォーム内容）」の情報を骨格とし、分析や行動例に必ず反映してください。\n情報が「未入力」または不足している場合は、あなたの持つ高度な業界知識をもとに最適解を補完してください。\n\n--- ヒアリングシート（入力フォーム内容） ---\n1. 業種： ${industry}\n2. 事業内容の詳細： ${businessDetail}\n3. 本社所在地： ${hqLocation}\n4. その他拠点： ${otherLocations}\n5. 営業エリア（商圏）： ${businessArea}\n6. 現在の社員数： ${employeeCount}\n7. 5年後の希望社員数： ${futureEmployeeCount}\n8. 顧客から褒められる点（強み）： ${strengths}\n9. 困っている点（課題）： ${issues}\n10. これから新しくやりたいこと： ${newInitiatives}\n11. どんなお客様に来てもらっているか： ${targetCustomers}\n12. お客様の流入経路： ${acquisitionChannel}\n13. どんな会社にしていきたいか（想い）： ${vision}\n---------------------------\n\n🏗️ 経営計画書の構成（全8章）\n1. 会社概要\n2. これから目指す姿（将来構想）\n3. 今の状況を知る（SWOT分析）： 強み・弱み・機会・脅威を各3項目以上、Markdown表で提示。\n4. 分析を活かす作戦（クロスSWOT）： SO・WO・ST・WTを各3項目以上、Markdown表で提示。\n5. 私たちの立ち位置（戦略の優先順位）： 下記の定義に基づき、3つのレベルに必ず振り分ける。\n6. 中期目標： 5年後までの年度別目標を具体的に提示。\n7. 商圏・市場戦略： 地域密着か広域か、具体的なターゲットを含めて提示。\n8. 戦略と施策（★省略禁止★）： 5区分すべてを10項目ずつ（計50項目）、具体的な行動リストとして出力。\n\n📋 「私たちの立ち位置」戦略の定義\nアクセス： 物理的な利便性（立地、反応の速さ）に加え、**知的・機能的利便性（専門的な情報、高度なスキル、解決策への接触可能性）**も含む。\n商品： 提供する物品、または提供する役務（サービスそのもの）の品質、機能、正確さ、ブランドとしての信頼性。\nサービス： 契約や購入の前後に付随する対人対応の質。マナー、アフターフォロー、気配りの徹底。\n価格： 市場相場との整合性と「納得感」のある値付け。\n経験価値： **顧客が抱く精神的な満足感や安心感。**自社はそれが生まれる「舞台」を徹底的に設計する。\n\n📋 戦略と施策の5区分（各10項目・計50項目すべて出力）\n1. 商品・サービスをどうするか\n2. お客様にどう伝えるか（営業・販促）\n3. 仕事の進め方と品質\n4. 働く仲間とチームづくり\n5. ムダをなくすデジタル活用\n\n🗣️ 出力トーンと形式\nトーン： 正式文書トーン（外部提出可）。難しい言葉を避け、自然体で読みやすく。\n形式： Googleドキュメントに貼り付け可能なMarkdown形式。各章冒頭に「方向性・想い」を一文添える。\n**【重要】読みやすさを確保するため、各段落や項目の間には十分な改行を入れて出力してください。**\n\n【出力後の案内】 \n計画書の本文が終わった後に、区切り線（---）を引き、必ず以下の形式で利用者への案内を出力してください（改行も再現すること）。\n\n---\n**【この経営計画書の使い方】**\n\nこの計画書は、Googleドキュメント等に貼り付けてそのままお使いいただける形式で作成しました。\n\n1. **保存方法（重要）**\n   画面上に表示されている**「全文をコピーする」ボタン**を押してください。\n   計画書の内容がすべてコピーされますので、その後GoogleドキュメントやWordに貼り付けて保存してください。\n\n2. **活用のアドバイス**\n   スライド資料にする場合は、この計画書を原稿として利用するか、専門業者への依頼資料としてご活用ください。\n\n3. **免責事項**\n   本内容はAIが業界知識やヒアリング情報を基に作成した「参考情報」です。\n   売上高や利益計画などの詳細な「数値計画」は出力されません。\n   経営実態と異なる箇所がないかご自身で確認・修正し、最終的な判断は利用者様の責任において行ってください。\n`;\n\n  // ▼▼▼ 修正箇所：診断リストにあった「実験版（exp）」を指定 ▼▼▼\n  // これなら無料枠の制限が別枠なので、通る可能性が高いです！\n  const modelName = 'gemini-2.0-flash-exp';\n  const url = `https://generativelanguage.googleapis.com/v1beta/models/${modelName}:generateContent?key=${apiKey}`;\n\n  const payload = {\n    contents: [\n      {\n        parts: [\n          { text: prompt }\n        ]\n      }\n    ]\n  };\n\n  try {\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify(payload)\n    });\n\n    const data = await response.json();\n\n    if (!response.ok) {\n      // エラーがあれば詳細を表示\n      const errorMessage = data.error?.message || response.statusText;\n      console.error(\"Gemini API Error:\", data);\n      throw new Error(`AIエラー: ${errorMessage}`);\n    }\n\n    // 成功した場合、テキストを取り出す\n    const text = data.candidates?.[0]?.content?.parts?.[0]?.text;\n    \n    if (!text) {\n      throw new Error(\"AIからの応答が空でした。\");\n    }\n\n    return text;\n\n  } catch (error: any) {\n    console.error('通信エラー:', error);\n    throw new Error(error.message || '予期せぬエラーが発生しました');\n  }\n}"],"names":[],"mappings":";;;;;;;AAEO,eAAe,uBAAuB,QAAkB;IAC7D,MAAM,SAAS,QAAQ,GAAG,CAAC,cAAc;IAEzC,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,UAAU;IACV,MAAM,WAAW,SAAS,GAAG,CAAC,eAAyB;IACvD,MAAM,iBAAiB,SAAS,GAAG,CAAC,qBAA+B;IACnE,MAAM,aAAa,SAAS,GAAG,CAAC,iBAA2B;IAC3D,MAAM,iBAAiB,SAAS,GAAG,CAAC,qBAA+B;IACnE,MAAM,eAAe,SAAS,GAAG,CAAC,mBAA6B;IAC/D,MAAM,gBAAgB,SAAS,GAAG,CAAC,oBAA8B;IACjE,MAAM,sBAAsB,SAAS,GAAG,CAAC,0BAAoC;IAC7E,MAAM,YAAY,SAAS,GAAG,CAAC,gBAA0B;IACzD,MAAM,SAAS,SAAS,GAAG,CAAC,aAAuB;IACnD,MAAM,iBAAiB,SAAS,GAAG,CAAC,qBAA+B;IACnE,MAAM,kBAAkB,SAAS,GAAG,CAAC,sBAAgC;IACrE,MAAM,qBAAqB,SAAS,GAAG,CAAC,yBAAmC;IAC3E,MAAM,SAAS,SAAS,GAAG,CAAC,aAAuB;IAEnD,aAAa;IACb,MAAM,SAAS,CAAC;;;;;;;;;;;OAWX,EAAE,SAAS;YACN,EAAE,eAAe;UACnB,EAAE,WAAW;UACb,EAAE,eAAe;cACb,EAAE,aAAa;WAClB,EAAE,cAAc;cACb,EAAE,oBAAoB;mBACjB,EAAE,UAAU;eAChB,EAAE,OAAO;mBACL,EAAE,eAAe;sBACd,EAAE,gBAAgB;cAC1B,EAAE,mBAAmB;uBACZ,EAAE,OAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDhC,CAAC;IAEC,sCAAsC;IACtC,+BAA+B;IAC/B,MAAM,YAAY;IAClB,MAAM,MAAM,CAAC,wDAAwD,EAAE,UAAU,qBAAqB,EAAE,QAAQ;IAEhH,MAAM,UAAU;QACd,UAAU;YACR;gBACE,OAAO;oBACL;wBAAE,MAAM;oBAAO;iBAChB;YACH;SACD;IACH;IAEA,IAAI;QACF,MAAM,WAAW,MAAM,MAAM,KAAK;YAChC,QAAQ;YACR,SAAS;gBACP,gBAAgB;YAClB;YACA,MAAM,KAAK,SAAS,CAAC;QACvB;QAEA,MAAM,OAAO,MAAM,SAAS,IAAI;QAEhC,IAAI,CAAC,SAAS,EAAE,EAAE;YAChB,eAAe;YACf,MAAM,eAAe,KAAK,KAAK,EAAE,WAAW,SAAS,UAAU;YAC/D,QAAQ,KAAK,CAAC,qBAAqB;YACnC,MAAM,IAAI,MAAM,CAAC,OAAO,EAAE,cAAc;QAC1C;QAEA,mBAAmB;QACnB,MAAM,OAAO,KAAK,UAAU,EAAE,CAAC,EAAE,EAAE,SAAS,OAAO,CAAC,EAAE,EAAE;QAExD,IAAI,CAAC,MAAM;YACT,MAAM,IAAI,MAAM;QAClB;QAEA,OAAO;IAET,EAAE,OAAO,OAAY;QACnB,QAAQ,KAAK,CAAC,UAAU;QACxB,MAAM,IAAI,MAAM,MAAM,OAAO,IAAI;IACnC;AACF;;;IAjJsB;;AAAA,+OAAA"}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {generateManagementPlan as '402de835c6f2b7e0fd639fbdf46f55bf2fe54478bf'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts"],"sourcesContent":["/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n"],"names":["registerServerReference"],"mappings":"AAAA,oDAAoD;;;+BAC3CA,2BAAAA;;;eAAAA,QAAAA,uBAAuB;;;wBAAQ","ignoreList":[0]}},
    {"offset": {"line": 187, "column": 0}, "map": {"version":3,"sources":["file:///Users/tatsuma/%E2%96%A0%E2%96%A0dev/management-plan/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts"],"sourcesContent":["// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n"],"names":["ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"AAAA,+EAA+E;AAC/E,yEAAyE;AACzE,iEAAiE;;;;+BACjDA,4BAAAA;;;eAAAA;;;AAAT,SAASA,yBAAyBC,OAAc;IACrD,IAAK,IAAIC,IAAI,GAAGA,IAAID,QAAQE,MAAM,EAAED,IAAK;QACvC,MAAME,SAASH,OAAO,CAACC,EAAE;QACzB,IAAI,OAAOE,WAAW,YAAY;YAChC,MAAM,OAAA,cAEL,CAFK,IAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,OAAO,uEAAuE,CAAC,GADhJ,qBAAA;uBAAA;4BAAA;8BAAA;YAEN;QACF;IACF;AACF","ignoreList":[0]}}]
}